name: ğŸš€ Deploy selected packages to GitHub Pages

# åªè¦ push åˆ° mainï¼Œå°±æœƒè§¸ç™¼
on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:

      # 1. å…ˆæŠŠç¨‹å¼ç¢¼æ‹‰ä¸‹ä¾†
      - name: Checkout code
        uses: actions/checkout@v3

      # 2. æº–å‚™ä¸€å€‹æš«å­˜è³‡æ–™å¤¾ public/
      - name: Prepare public directory
        run: |
          # å»ºè³‡æ–™å¤¾
          mkdir public

          # æŠŠæ‰€æœ‰ packages è£¡çš„æ±è¥¿åŒæ­¥åˆ° public
          # ä½†æ’é™¤ä¸æƒ³ Deploy çš„ siteâ€‘X
          rsync -av packages/ public/ \
            --exclude 'js-practice' 

          # ï¼ˆå¦‚æœä½ æƒ³åªåŒ…å« site-Aã€site-Cï¼Œå¯ä»¥æ”¹æˆ --include 'site-A' --include 'site-C' --exclude '*'ï¼‰

      # 3. è¨­å®š Pages (å‘Šè¨´ GH è¦ç”¨ Actions ä¾†ç™¼ä½ˆ)
      - name: Configure GitHub Pages
        uses: actions/configure-pages@v3

      # 4. ä¸Šå‚³è¦ç™¼ä½ˆçš„ç”¢ç‰©
      - name: Upload artifact for Pages
        uses: actions/upload-pages-artifact@v3
        with:
          path: public

      # 5. åŸ·è¡ŒçœŸæ­£çš„éƒ¨ç½²
      - name: Deploy to GitHub Pages
        uses: actions/deploy-pages@v4
